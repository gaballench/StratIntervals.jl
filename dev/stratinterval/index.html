<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stratigraphic intervals · StratIntervals.jl</title><meta name="title" content="Stratigraphic intervals · StratIntervals.jl"/><meta property="og:title" content="Stratigraphic intervals · StratIntervals.jl"/><meta property="twitter:title" content="Stratigraphic intervals · StratIntervals.jl"/><meta name="description" content="Documentation for StratIntervals.jl."/><meta property="og:description" content="Documentation for StratIntervals.jl."/><meta property="twitter:description" content="Documentation for StratIntervals.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="StratIntervals.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="StratIntervals.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">StratIntervals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Stratigraphic intervals</a><ul class="internal"><li><a class="tocitem" href="#The-StratInterval-data-structure"><span>The <code>StratInterval</code> data structure</span></a></li><li><a class="tocitem" href="#Defining-a-stratigraphic-interval"><span>Defining a stratigraphic interval</span></a></li><li><a class="tocitem" href="#Specifying-priors"><span>Specifying priors</span></a></li><li><a class="tocitem" href="#Collections-of-stratigraphic-intervals"><span>Collections of stratigraphic intervals</span></a></li></ul></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li><a class="tocitem" href="../conflation/">Conflation of PDFs</a></li><li><a class="tocitem" href="../turingmodel/">Sampling a stratigraphic interval and posterior predictive</a></li><li><a class="tocitem" href="../api/">Public  API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Stratigraphic intervals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stratigraphic intervals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl/blob/main/docs/src/stratinterval.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Stratigraphic-intervals-and-how-to-define-them"><a class="docs-heading-anchor" href="#Stratigraphic-intervals-and-how-to-define-them">Stratigraphic intervals and how to define them</a><a id="Stratigraphic-intervals-and-how-to-define-them-1"></a><a class="docs-heading-anchor-permalink" href="#Stratigraphic-intervals-and-how-to-define-them" title="Permalink"></a></h1><h2 id="The-StratInterval-data-structure"><a class="docs-heading-anchor" href="#The-StratInterval-data-structure">The <code>StratInterval</code> data structure</a><a id="The-StratInterval-data-structure-1"></a><a class="docs-heading-anchor-permalink" href="#The-StratInterval-data-structure" title="Permalink"></a></h2><p>The data structure that is provided in the package is called <a href="../api/#StratIntervals.StratInterval">StratInterval</a>. It provides four fields for specifying both data and priors:</p><ul><li><code>data</code> is a vector of <code>Float64</code> with the age occurrences</li><li><code>θ1_prior</code> prior distribution for <span>$\theta_1$</span>  </li><li><code>θ2_prior</code> prior distribution for <span>$\theta_2$</span></li><li><code>λ_prior</code> prior distribution for <span>$\lambda$</span></li></ul><p>We will discuss below each of these elements.</p><h2 id="Defining-a-stratigraphic-interval"><a class="docs-heading-anchor" href="#Defining-a-stratigraphic-interval">Defining a stratigraphic interval</a><a id="Defining-a-stratigraphic-interval-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-stratigraphic-interval" title="Permalink"></a></h2><p>A stratigraphic interval is a collection of time occurrences preserved in the fossil record. For instance, Let us consider the Ammonite in the Figure below, it speciated at time <span>$\theta_1$</span>, lived for some time, and then became extinct at time <span>$\theta_2$</span>. The pattern of preservation is governed by a quantity called <span>$\lambda$</span>, which determines how likely it is to become preserved as we proceed in time.</p><p>Normally, we have access to some collection of preserved occurrences in time, but the first and last of these, called the First Appearance Datum (FAD) and Last Appearance Datum (LAD) have very little probability of being the true origination and extinction times of the species in the fossil record. If we use these quantities for measuring how long the species was living on earth, we will bias our estimates, and therefore consider FADs and LADs biaset estimators for the true origination and extinction times <span>$\theta_1$</span> and <span>$\theta_2$</span>.</p><p>The plots below show different patterns of preservation in which the histograms represet the relative frequence of fossil occurrences in time. As we can see, the patterns can be quite different depending on the value of <span>$\lambda$</span>. In fact, the histograms are showing collections of occurrences sampled at random from these stratigraphic intervals for fixed values of <span>$\theta_1$</span>, <span>$\theta_2$</span>, and <span>$\lambda$</span>.    </p><p><img src="../assets/stratintervals_plate.svg" alt/></p><p>Living Ammonite <a href="https://doi.org/10.7875/togopic.2020.08">https://doi.org/10.7875/togopic.2020.08</a>, fossil Ammonite <a href="https://commons.wikimedia.org/wiki/User:Ilzolende">https://commons.wikimedia.org/wiki/User:Ilzolende</a>.</p><h3 id="With-&quot;exact&quot;-data"><a class="docs-heading-anchor" href="#With-&quot;exact&quot;-data">With &quot;exact&quot; data</a><a id="With-&quot;exact&quot;-data-1"></a><a class="docs-heading-anchor-permalink" href="#With-&quot;exact&quot;-data" title="Permalink"></a></h3><p>Any method makes assumptions about the data and how these were generated. This time we will make three assumptions:</p><ol><li><p>Preservation potential is continuous and constant through time,</p></li><li><p>Time occurrences are measured without error</p></li><li><p>Preservation of each occurrence is independent from the preservation of other occurrences. That is, occurrences are independent and identically distributed. </p></li></ol><p>In this context, &quot;exact&quot; data, or occurrences measured without error means that there is no uncertainty associated to the age for a given occurrence. For example, a particular fossil may have its age dated as 32.4 Ma. Neither 31, nor 33, exactly 32.4. This is of course impossible as we cannot attain infinite precision in continuous measurements, but it is at least important that we can fix the data in a given model so that we can calculate parameter values later on. As an example, we may have a vector of fossil occurrences (in Ma) for a given extinct species as follows: <code>[36.0, 35.8, 33.4, 33.01, 32.9]</code>.</p><p>But again, this is not how the fossil record works. Anyone familiar with fossils and how we tell their age knows that for the vast majority of fossil occurrences have an interval for its age, that is, we can only guess its age with intrinsic error. For example, a given fossil may be said to be from about 34.0 and 32.3 Ma, or from the Miocene, which is essentially the interval between 23.03 and 5.333 Ma. How to deal with that undesirable property of real data?</p><h3 id="Data-with-uncertainty:-Intervals"><a class="docs-heading-anchor" href="#Data-with-uncertainty:-Intervals">Data with uncertainty: Intervals</a><a id="Data-with-uncertainty:-Intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Data-with-uncertainty:-Intervals" title="Permalink"></a></h3><p>Let us consider an actual example from the fossil record. We downloaded some data for the Catfish genus <em>Phractocephalus</em> from the <a href="https://paleobiodb.org/">Paleobiology Database</a>. Among other data in published references, we can focus on the age information of these occurrences. These are the columns <code>early_interval</code>, <code>late_interval</code>, <code>max_ma</code>, and <code>min_ma</code>.</p><table><tr><th style="text-align: center">occurrence_no</th><th style="text-align: center">accepted_name</th><th style="text-align: center">early_interval</th><th style="text-align: center">late_interval</th><th style="text-align: center">max_ma</th><th style="text-align: center">min_ma</th><th style="text-align: center">midpoint_ma</th><th style="text-align: center">interval_length</th></tr><tr><td style="text-align: center">1088124</td><td style="text-align: center">Phractocephalus acreornatus</td><td style="text-align: center">Late Miocene</td><td style="text-align: center"></td><td style="text-align: center">11.63</td><td style="text-align: center">5.333</td><td style="text-align: center">8.4815</td><td style="text-align: center">6.297</td></tr><tr><td style="text-align: center">1088132</td><td style="text-align: center">Phractocephalus acreornatus</td><td style="text-align: center">Tortonian</td><td style="text-align: center"></td><td style="text-align: center">11.63</td><td style="text-align: center">7.246</td><td style="text-align: center">9.438</td><td style="text-align: center">4.384</td></tr><tr><td style="text-align: center">1088367</td><td style="text-align: center">Phractocephalus nassi</td><td style="text-align: center">Late Miocene</td><td style="text-align: center"></td><td style="text-align: center">11.63</td><td style="text-align: center">5.333</td><td style="text-align: center">8.4815</td><td style="text-align: center">6.297</td></tr><tr><td style="text-align: center">1088377</td><td style="text-align: center">Phractocephalus nassi</td><td style="text-align: center">Tortonian</td><td style="text-align: center"></td><td style="text-align: center">11.63</td><td style="text-align: center">7.246</td><td style="text-align: center">9.438</td><td style="text-align: center">4.384</td></tr><tr><td style="text-align: center">1312353</td><td style="text-align: center">Phractocephalus</td><td style="text-align: center">Late Oligocene</td><td style="text-align: center"></td><td style="text-align: center">27.82</td><td style="text-align: center">23.03</td><td style="text-align: center">25.425</td><td style="text-align: center">4.79</td></tr><tr><td style="text-align: center">1312539</td><td style="text-align: center">Phractocephalus</td><td style="text-align: center">Tortonian</td><td style="text-align: center"></td><td style="text-align: center">11.63</td><td style="text-align: center">7.246</td><td style="text-align: center">9.438</td><td style="text-align: center">4.384</td></tr><tr><td style="text-align: center">1368948</td><td style="text-align: center">Phractocephalus hemiliopterus</td><td style="text-align: center">Laventan</td><td style="text-align: center"></td><td style="text-align: center">13.7</td><td style="text-align: center">10.9</td><td style="text-align: center">12.3</td><td style="text-align: center">2.8</td></tr><tr><td style="text-align: center">1386572</td><td style="text-align: center">Phractocephalus</td><td style="text-align: center">Santacrucian</td><td style="text-align: center">Friasian</td><td style="text-align: center">17.4</td><td style="text-align: center">15.4</td><td style="text-align: center">16.4</td><td style="text-align: center">2</td></tr><tr><td style="text-align: center">1587033</td><td style="text-align: center">Phractocephalus</td><td style="text-align: center">Langhian</td><td style="text-align: center"></td><td style="text-align: center">15.98</td><td style="text-align: center">13.82</td><td style="text-align: center">14.9</td><td style="text-align: center">2.16</td></tr><tr><td style="text-align: center">1595384</td><td style="text-align: center">Phractocephalus</td><td style="text-align: center">Early Oligocene</td><td style="text-align: center"></td><td style="text-align: center">33.9</td><td style="text-align: center">27.82</td><td style="text-align: center">30.86</td><td style="text-align: center">6.08</td></tr></table><p>This shows how real-world age information is found in the literature: In the form of intervals. Quite often information comes from biostratigraphy or correlation, which uses age intervals according to the <a href="https://stratigraphy.org/chart">International Chronostratigraphic Chart</a>. We need to use the numerical representation of such intervals, which we find in the columns <code>max_ma</code> and <code>min_max</code>. There are two options for using these data in analytical palaeobiology: We can calculate the midpoint of the interval and pretend that it is measured without error, or we can use the interval and sample from it. This way we can use e.g. resampling techniques for incorporating the uncertainty associated to each age. </p><h2 id="Specifying-priors"><a class="docs-heading-anchor" href="#Specifying-priors">Specifying priors</a><a id="Specifying-priors-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-priors" title="Permalink"></a></h2><p>Priors are distributions which describe our beliefs about possible values for the parameters of interest. For instance, if our model is a Binomial distribution with parameter <span>$\theta$</span>, the proportion of success, a natural choice for describing our prior knowledge on it may be the Beta distribution, which is bound to the interval <span>$[0,1]$</span>, such as proportions. The specific values of <span>$\alpha$</span> and <span>$\beta$</span> will define which values of <span>$\theta$</span> are more probable. It is even possible that any value between 0 and 1 is equally likely, when <span>$\alpha$</span> and <span>$\beta$</span> are equal to 1.</p><p>Distributions are defined using the <a href="https://juliastats.org/Distributions.jl/">Distributions.jl</a> package. The syntax for defining priors is as follows:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; param1_prior = Normal(50, 3)</code><code class="nohighlight hljs ansi" style="display:block;">Normal{Float64}(μ=50.0, σ=3.0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pdf(param1_prior, 51.0)</code><code class="nohighlight hljs ansi" style="display:block;">0.12579440923099772</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(param1_prior)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;prior.svg&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../prior.svg" alt/></p><p>In the example above, we defined the prior on param1 as <span>$N(\mu=50, \sigma=3)$</span>.</p><p>We normally want priors that are at least mostly with support in <span>$\tau \in [0, \infty)$</span>. Also, we want to set the priors on <span>$\theta_1$</span> and <span>$\theta_2$</span> so that <span>$\theta_1 &gt; \theta_2$</span> (because it is in Ma <em>before present</em>). Also, it is useful to set the prior on <span>$\lambda$</span> centered at 0.0 but with enough variance as to allow values between -4 and 4, which allows a great amount of different shapes.</p><h2 id="Collections-of-stratigraphic-intervals"><a class="docs-heading-anchor" href="#Collections-of-stratigraphic-intervals">Collections of stratigraphic intervals</a><a id="Collections-of-stratigraphic-intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Collections-of-stratigraphic-intervals" title="Permalink"></a></h2><p>Now we have different ways of specifying species through geologic time as a probability density function with respect to <span>$\tau$</span>. We can use conflation to combine these if we have multiple so that we develop a probabilistic model for the co-occurrence of these individual intervals. In other words, such distribution describes the probability of all of them co-existing at the same time.</p><p>The figure below shows the stratigraphic intervals of five different species of Ammonites. What is the distribution of having them living all at the same time, possibly co-existing in space? Such model can be used to tell the age of such co-existence, and can be used to estimate e.g. the age of fossil assemblages (blue distribution).</p><p><img src="../assets/conflation_plate.svg" alt/></p><p>Ammonite drawings courtesy of <a href="https://www.researchgate.net/profile/Jorge-Moreno-Bernal">Jorge W. Moreno-Bernal</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../distributions/">Distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 25 February 2025 21:40">Tuesday 25 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
