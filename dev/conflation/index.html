<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Conflation of PDFs · StratIntervals.jl</title><meta name="title" content="Conflation of PDFs · StratIntervals.jl"/><meta property="og:title" content="Conflation of PDFs · StratIntervals.jl"/><meta property="twitter:title" content="Conflation of PDFs · StratIntervals.jl"/><meta name="description" content="Documentation for StratIntervals.jl."/><meta property="og:description" content="Documentation for StratIntervals.jl."/><meta property="twitter:description" content="Documentation for StratIntervals.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="StratIntervals.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="StratIntervals.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">StratIntervals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../stratinterval/">Stratigraphic intervals</a></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li class="is-active"><a class="tocitem" href>Conflation of PDFs</a></li><li><a class="tocitem" href="../turingmodel/">Sampling a stratigraphic interval and posterior predictive</a></li><li><a class="tocitem" href="../api/">Public  API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Conflation of PDFs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Conflation of PDFs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl/blob/main/docs/src/conflation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Conflation:-Combining-distributions"><a class="docs-heading-anchor" href="#Conflation:-Combining-distributions">Conflation: Combining distributions</a><a id="Conflation:-Combining-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Conflation:-Combining-distributions" title="Permalink"></a></h1><p>Combining different distributions is not straitghforward (Genest and Zidek, 1986). However, the conflation of probability density functions is a useful procedure which combines them provided that each of them is independent (Hill, 2011; Hill and Miller, 2011).  Assuming that each distribution describing the same parameter is independent, we can define the composite distribution of <span>$\tau$</span> for <span>$M$</span> intervals as the conflation of individual distributions:</p><p class="math-container">\[\begin{equation}
  \begin{aligned}
    Q(\tau) = \frac{ \prod_{i=1}^{M} p_i(\tau)}{\int_{-\infty}^{\infty} \prod_{i=1}^{M} p_i(x) \mathrm{d}x}
  \end{aligned}
\end{equation}\]</p><p>Such distribution is useful e.g. when we want to build credible intervals for the time <span>$\tau$</span> of co-occurrence of stratigraphic intervals. The conceptual interpretation as follows: <span>$M$</span> different lineages as represented by their stratigraphic intervals should coexist at most for some time interval when they all were alive. As the conflation of densities is a density itself, it can be used for asking questions on the probability of co-existence of lineages during some arbitrary time interval given the distribution.</p><p>The application of conflation is however more general than the specific case where we combine different posterior predictives as the distribution of the co-occurrence of stratigraphic intervals. Ballen and Reinales (2025) have used the method for combining distributions into secondary calibrations as well as for estimating biogeographic events in divergence time estimation. As long as we have a vector of distributions, the calculation of their conflation is straightforward:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dists = product_distribution([Normal(10, 2), Normal(11, 4), Normal(8, 5)])</code><code class="nohighlight hljs ansi" style="display:block;">Product{Continuous, Normal{Float64}, Vector{Normal{Float64}}}(v=Normal{Float64}[Normal{Float64}(μ=10.0, σ=2.0), Normal{Float64}(μ=11.0, σ=4.0), Normal{Float64}(μ=8.0, σ=5.0)])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; xx = 5:0.0001:15</code><code class="nohighlight hljs ansi" style="display:block;">5.0:0.0001:15.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; yy = map(x -&gt; conflate(dists, x), xx);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(xx, yy, label=&quot;Conflation&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(Normal(10, 2), label=&quot;Normal(10, 2)&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(Normal(11, 4), label=&quot;Normal(11, 4)&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(Normal(8, 5), label=&quot;Normal(8, 5)&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=4}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;conflation_example.svg&quot;);</code><code class="nohighlight hljs ansi" style="display:block;">GKS: cannot open display - headless operation mode active</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../conflation_example.svg" alt/></p><p>The <code>conflate</code> function also supports an input consisting of a vector of distributions, that is, without the need to use <code>product_distribution</code> before calling <code>conflate</code>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; conflate([Normal(10, 2), Normal(11, 4), Normal(8, 5)], 9.8)</code><code class="nohighlight hljs ansi" style="display:block;">0.2359169933939096</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; conflate([Uniform(0,1), Uniform(0,1)], 0.5)</code><code class="nohighlight hljs ansi" style="display:block;">1.000000000169033</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p>It is also possible to conflate empirical distributions defined by Kernel Densities. Supose we have two collections of values in the objects <code>empirica1_vec</code> and <code>empirical2_vec</code> <em>which are of the same length</em>, and we want to conflate them:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Random</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Random.seed!(1507)
       
       #empirical1</code><code class="nohighlight hljs ansi" style="display:block;">Random.TaskLocalRNG()</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; empirical1_vec = rand(Normal(0, 1), 20)
       #empirical2</code><code class="nohighlight hljs ansi" style="display:block;">20-element Vector{Float64}:
 -1.319258037366362
  1.0005337555526206
  0.750539021144979
 -0.009058532698321306
 -0.5523505659119602
 -1.384973961343394
 -0.22857752318154667
 -0.8511098167206834
 -1.0299614587977524
 -1.1658039374991538
  0.36652920768444747
 -1.2232904284509156
  2.7206011426891012
 -0.3447129116509491
  1.2708990441502748
  1.8916044043383082
 -0.22220658123099474
  1.1214827711299564
 -0.22953943009989353
 -0.11199480310204413</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; empirical2_vec = rand(Uniform(1, 2), 20)
       # stack them together in a matrix, column-wise</code><code class="nohighlight hljs ansi" style="display:block;">20-element Vector{Float64}:
 1.3416865866071714
 1.3701029939635738
 1.1827820614597884
 1.5565685825132747
 1.772228970346836
 1.5657605248486977
 1.2925339534582683
 1.984989717358323
 1.262776469275738
 1.5657058204188576
 1.2581400239292109
 1.0707808838469168
 1.7545257849881333
 1.4756247788395815
 1.3238207966033084
 1.055654334609133
 1.7361306866418287
 1.9652653424853526
 1.734689763900406
 1.6269169932543501</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; empirical_matrix = [empirical1_vec empirical2_vec]</code><code class="nohighlight hljs ansi" style="display:block;">20×2 Matrix{Float64}:
 -1.31926     1.34169
  1.00053     1.3701
  0.750539    1.18278
 -0.00905853  1.55657
 -0.552351    1.77223
 -1.38497     1.56576
 -0.228578    1.29253
 -0.85111     1.98499
 -1.02996     1.26278
 -1.1658      1.56571
  0.366529    1.25814
 -1.22329     1.07078
  2.7206      1.75453
 -0.344713    1.47562
  1.2709      1.32382
  1.8916      1.05565
 -0.222207    1.73613
  1.12148     1.96527
 -0.229539    1.73469
 -0.111995    1.62692</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; xx = -4:0.01:4</code><code class="nohighlight hljs ansi" style="display:block;">-4.0:0.01:4.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; yy = map(x -&gt; conflate(empirical_matrix, x), xx);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(xx, yy, label=&quot;Conflation&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; density!(empirical1_vec, label=&quot;Empirical 1&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; density!(empirical2_vec, label=&quot;Empirical 2&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;conflation_empiricals_samelength.svg&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../conflation_empiricals_samelength.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../distributions/">« Distributions</a><a class="docs-footer-nextpage" href="../turingmodel/">Sampling a stratigraphic interval and posterior predictive »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Thursday 1 May 2025 16:52">Thursday 1 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
