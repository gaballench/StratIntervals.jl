<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Distributions · StratIntervals.jl</title><meta name="title" content="Distributions · StratIntervals.jl"/><meta property="og:title" content="Distributions · StratIntervals.jl"/><meta property="twitter:title" content="Distributions · StratIntervals.jl"/><meta name="description" content="Documentation for StratIntervals.jl."/><meta property="og:description" content="Documentation for StratIntervals.jl."/><meta property="twitter:description" content="Documentation for StratIntervals.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="StratIntervals.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="StratIntervals.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">StratIntervals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../stratinterval/">Stratigraphic intervals</a></li><li class="is-active"><a class="tocitem" href>Distributions</a><ul class="internal"><li><a class="tocitem" href="#Three-Parameter-Beta-distribution"><span>Three-Parameter Beta distribution</span></a></li><li><a class="tocitem" href="#Reflected-Offset-Exponential-distribution"><span>Reflected-Offset Exponential distribution</span></a></li></ul></li><li><a class="tocitem" href="../conflation/">Conflation of PDFs</a></li><li><a class="tocitem" href="../turingmodel/">Sampling a stratigraphic interval and posterior predictive</a></li><li><a class="tocitem" href="../api/">Public  API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Distributions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Distributions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gaballench/StratIntervals.jl/blob/main/docs/src/distributions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Distribution-methods-documented-here"><a class="docs-heading-anchor" href="#Distribution-methods-documented-here">Distribution methods documented here</a><a id="Distribution-methods-documented-here-1"></a><a class="docs-heading-anchor-permalink" href="#Distribution-methods-documented-here" title="Permalink"></a></h1><p>Some distributions are implemented either for the likelihood function or priors. </p><p>Please note that all the recommended methods for <a href="https://juliastats.org/Distributions.jl/stable/extends">new samplers and distributions</a> have been implemented, so we can use <code>pdf</code>, <code>cdf</code>, <code>minimum</code>, <code>maximum</code>, <code>insupport</code>, as well as <code>rand</code> with the distributions herein described. For detais see the public API on the sidebar.</p><h2 id="Three-Parameter-Beta-distribution"><a class="docs-heading-anchor" href="#Three-Parameter-Beta-distribution">Three-Parameter Beta distribution</a><a id="Three-Parameter-Beta-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Three-Parameter-Beta-distribution" title="Permalink"></a></h2><p>The Three-Parameter Beta distribution is defined as follows:</p><p class="math-container">\[\begin{equation}
  \begin{aligned}
  f(\tau; \theta_1,\theta_2,\lambda) = \frac{(\theta_2 - \tau)^{-\lambda}}{(\theta_2 - \theta_1)^{1-\lambda} B(1,1-\lambda)} \mathrm{\ if\ }\lambda \leq 0 \\
  \mathrm{\ where\ } B(1,1-\lambda) = \int_{0}^{1} t^{1+\lambda-1} (1-t)^{1-1} \mathrm{d}t = \frac{1}{1-\lambda}
  \end{aligned}
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
  \begin{aligned}
  f(\tau; \theta_1,\theta_2,\lambda) = \frac{(\tau-\theta_1)^{\lambda}}{(\theta_2 - \theta_1)^{1+\lambda} B(1+\lambda,1)} \mathrm{\ if\ }\lambda &gt; 0 \\
  \mathrm{\ where\ } B(1+\lambda,1) = \int_{0}^{1} t^{1-1} (1-t)^{1-\lambda-1} \mathrm{d}t = \frac{1}{1+\lambda}
  \end{aligned}
\end{equation}\]</p><p>The parameters <span>$\theta_1$</span> and <span>$\theta_2$</span> are the endpoints of the tratigraphic interval, and <span>$\lambda$</span> is the paremeter governing the probability of preservation through time.</p><p>Assuming that time occurrences are independent and identically distributed, we can also calculate the likelihood of observing a vector representing the collection of <span>$N$</span> time occurrences given a stratigraphic interval by the product of likelihoods of individual time occurrences:</p><p class="math-container">\[\begin{equation}
  \begin{aligned}
    f(\boldsymbol{\tau}; \theta_1,\theta_2,\lambda) = \prod_{i = 1}^{N} f(\tau_i | \theta_1,\theta_2,\lambda)  
  \end{aligned}
\end{equation}\]</p><p>This is the core element of the model for inference of stratigraphic interval as it is used as likelihood function, which describes the probability of observing the data.</p><h2 id="Reflected-Offset-Exponential-distribution"><a class="docs-heading-anchor" href="#Reflected-Offset-Exponential-distribution">Reflected-Offset Exponential distribution</a><a id="Reflected-Offset-Exponential-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Reflected-Offset-Exponential-distribution" title="Permalink"></a></h2><p>Sometimes we want priors which are asymmetric and one-tailed. One interesting option is the Exponential distribution, but unfortunately it is bounded to <span>$[0,\infty)$</span>, and always has a tail to the right. Sometimes we may want an Exponential which is displaced to some arbitrary point in the Real line, and we may also want it to have the tail to the left  instead.</p><p>In order to satisfy these needs, the package provides the <code>RefOffExponential</code> distribution. It has an additional set of parameters, called offset <span>$o$</span> and reflection <span>$\rho$</span> parameters. The offset is where the distribution will have its new zero, and the reflection quantity is either -1 or 1, the former for a reflection with respect to <span>$x = 0$</span> and the latter the unreflected form.</p><p>The parameter <span>$\theta$</span> is the usual scale parameter. Note that this last parameter is counted forward from the offset. For instance, if the offset is 50 and we want a distribution starting in 50 but with mean 100, <span>$\theta$</span> will need to be 50. Note that if offset and reflection are being used, then the mean will be counting <em>backwards</em> from the offset.</p><p>The PDF of the <code>ReffOffExponential</code> is the following:</p><p class="math-container">\[\begin{equation}
  \begin{aligned}
    f(x; \theta) = \rho \left(\frac{1}{\theta} e^{-\frac{x-o}{\theta}}\right), \quad x &gt; 0
  \end{aligned}
\end{equation}\]</p><p>This is an example of the <code>RefOffExponential</code> without offset and reflection, and mean = 4:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(RefOffExponential(4, 0.0, 1))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;refoffexp4_0_1.svg&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../refoffexp4_0_1.svg" alt/></p><p>Now with offset = 10, and mean in 14, without reflection:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(RefOffExponential(4, 10.0, 1))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;refoffexp4_10_1.svg&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../refoffexp4_10_1.svg" alt/></p><p>Now without offset, and mean in -6, with reflection:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(RefOffExponential(6, 0.0, -1))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;refoffexp6_0_minus1.svg&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../refoffexp6_0_minus1.svg" alt/></p><p>And finally, with both offset = 20, mean = 15  and reflection:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StratIntervals</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(RefOffExponential(5, 20, -1))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;refoffexp5_20_minus1.svg&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nothing</code></pre><p><img src="../refoffexp5_20_minus1.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stratinterval/">« Stratigraphic intervals</a><a class="docs-footer-nextpage" href="../conflation/">Conflation of PDFs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 10 April 2025 17:42">Thursday 10 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
